<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport"
	      content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>随机字符串_zhouzefu@126.com</title>
</head>
<body>
<!-- 随机字符展示区域 -->
<div class="result" id="result"></div>
<!--长度选项-->
<div class="length" id="char_length"></div>
<!-- 公共函数 -->
<script src="../js/utils.js"></script>
<!-- 当前页面函数 -->
<script>
	/**
	 * 大写字母
	 * @type {string}
	 */
	const abc = 'qwertyuiopasdfghjklzxcvbnm';
	/**
	 * 小写字母
	 */
	const ABC = 'QWERTYUIOPASDFGHJKLZXCVBNM';
	/**
	 * 字符
	 */
	const symbol = `~!@#$%^&*()_+{}|":?><`;
	/**
	 * 开启大写字母
	 */
	let isABC = true;
	/**
	 * 开启小写字母
	 */
	let isAbc = true;
	/**
	 * 开启符号
	 */
	let isSymbol = false;
	/**
	 * 字符长度
	 */
	let charLength = 16;
	/**
	 * 最大长度
	 */
	let charLengthMax = 200;
	/**
	 * 字符长度进度条EL
	 */
	let progressDom = null;
	/**
	 * 字符长度输入框EL
	 */
	let inputDom = null;
	/**
	 * 页面加载时
	 * @param res
	 * @returns {*}
	 */
	window.onload = res => initPageData(res);
	
	/**
	 * 初始化页面数据
	 */
	function initPageData() {
		renderResultHtml(getRandomChar());
		renderLengthHtml();
	}
	
	/**
	 * 渲染长度DOM
	 */
	function renderLengthHtml() {
		// 	标题
		const titleEl = createEl('div');
		titleEl.classList = 'title';
		titleEl.innerHTML = '长度';
		// 	进度条
		const progressEl = createEl('progress');
		progressEl.classList = 'progress';
		progressEl.value = charLength;
		progressEl.max = charLengthMax;
		progressEl.onchange = res => onChangeProgress(res);
		progressDom = progressEl;
		// 	进度条输入框
		const inputEl = createEl('input');
		inputEl.classList = 'input';
		inputEl.value = charLength;
		inputEl.oninput = res => onInputCharLength(res);
		inputDom = inputEl;
		// 	装载
		$('char_length').appendChild(titleEl);
		$('char_length').appendChild(progressEl);
		$('char_length').appendChild(inputEl);
	}
	
	/**
	 * 输入事件
	 * 字符串长度输入框
	 */
	function onInputCharLength(res) {
		console.log('res ---------------------->', res);
	}
	
	/**
	 * 进度条改变事件
	 * @param {{}} res
	 */
	function onChangeProgress(res) {
		console.log('res --------------->', res);
	}
	
	/**
	 * 获取随机字符
	 */
	function getRandomChar() {
		let charArr = [];
		if (isABC) charArr.push(ABC);
		if (isAbc) charArr.push(abc);
		if (isSymbol) charArr.push(symbol);
		if (isEmpty(charArr)) return showToast('所选条件不能全为空');
		return generateRandomString(charArr.join(''), charLength);
	}
	
	/**
	 * 生成随机字符
	 * @param {string} characters
	 * @param {number} length
	 * @returns {string}
	 */
	function generateRandomString(characters, length = 16) {
		let result = '';
		for (let i = 0; i < length; i++) {
			result += characters.charAt(Math.floor(Math.random() * characters.length));
		}
		return result;
	}
	
	/**
	 * 更新是否选择大写字母
	 * @param isChoose
	 * @param _callback
	 */
	function updateIsABC(isChoose, _callback) {
		isABC = isChoose;
		callback(_callback);
	}
	
	/**
	 * 渲染随机字符串结果
	 * @param str
	 */
	function renderResultHtml(str) {
		const resultEl = $('result');
		resultEl.innerHTML = str;
	}
</script>
</body>
</html>
